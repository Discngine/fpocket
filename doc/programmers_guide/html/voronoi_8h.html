<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>fpocket: voronoi.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<img src="fpocket_logo_small.png" width="545" height="150">
<!-- Generated by Doxygen 1.5.6 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>voronoi.h File Reference</h1><code>#include &lt;math.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;ctype.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &quot;<a class="el" href="rpdb_8h-source.html">rpdb.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="writepdb_8h-source.html">writepdb.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="calc_8h-source.html">calc.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="utils_8h-source.html">utils.h</a>&quot;</code><br>
<code>#include &quot;../src/qhull/qvoronoi.h&quot;</code><br>
<code>#include &quot;<a class="el" href="memhandler_8h-source.html">memhandler.h</a>&quot;</code><br>

<p>
<a href="voronoi_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structs__vvertice.html">s_vvertice</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#beb4af6653b4d1cb89cb62f3cf87cf17">M_VORONOI_SUCCESS</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#e90a1520c3ca5a4b829d387d4d06b004">M_APOLAR_AS</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#235175bd6aa1a2a3b3d35e6e4445365e">M_POLAR_AS</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#9a3c197b6aed2e738902d35219c94c61">M_PREC_TOLERANCE</a>&nbsp;&nbsp;&nbsp;1e-5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#a997988bdd54ed39def3d823c9cf0c50">M_BUFSIZE</a>&nbsp;&nbsp;&nbsp;1e7</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#4d3a0a72e8648578095af06f60c5e66c">load_vvertices</a> (<a class="el" href="structs__pdb.html">s_pdb</a> *pdb, int min_apol_neigh, float ashape_min_size, float ashape_max_size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#ff07f3be2fee9344d3fcecd3b18aac62">testVvertice</a> (float xyz[3], int curNbIdx[4], <a class="el" href="structs__atm.html">s_atm</a> *atoms, float min_asph_size, float max_asph_size, <a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *lvvert)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#0cffdb4ff10d2af2fbdc139b7b789c06">set_barycenter</a> (<a class="el" href="structs__vvertice.html">s_vvertice</a> *v)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#e3ecf2620f9bec82cc0180c2efd5c091">is_in_lst_vert</a> (<a class="el" href="structs__vvertice.html">s_vvertice</a> **lst_vert, int nb_vert, int v_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#8553105087cea62c70a4c33d4f18aa96">is_in_lst_vert_p</a> (<a class="el" href="structs__vvertice.html">s_vvertice</a> **lst_vert, int nb_vert, <a class="el" href="structs__vvertice.html">s_vvertice</a> *vert)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#0fc0360fbb0a071ba6d49dedd57ba397">write_pqr_vert</a> (FILE *f, <a class="el" href="structs__vvertice.html">s_vvertice</a> *v)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#624ae3215f4659770cd761d5bbb70a39">write_pdb_vert</a> (FILE *f, <a class="el" href="structs__vvertice.html">s_vvertice</a> *v)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#621631ed13a0e6d72412f1551969a655">get_verts_volume_ptr</a> (<a class="el" href="structs__vvertice.html">s_vvertice</a> **verts, int nvert, int niter, float correct)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#0268e8ccbb2743b5e94e398a094644aa">print_vvertices</a> (FILE *f, <a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *lvvert)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="voronoi_8h.html#5d8ea86290bf16a736c4ae0bdd9b0baa">free_vert_lst</a> (<a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *lvvert)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="e90a1520c3ca5a4b829d387d4d06b004"></a><!-- doxytag: member="voronoi.h::M_APOLAR_AS" ref="e90a1520c3ca5a4b829d387d4d06b004" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_APOLAR_AS&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
alpha sphere type - hydrophilic alpha sphere 
<p>Definition at line <a class="el" href="voronoi_8h-source.html#l00057">57</a> of file <a class="el" href="voronoi_8h-source.html">voronoi.h</a>.</p>

<p>Referenced by <a class="el" href="voronoi_8c-source.html#l00187">fill_vvertices()</a>, <a class="el" href="descriptors_8c-source.html#l00309">get_vert_apolar_density()</a>, <a class="el" href="descriptors_8c-source.html#l00182">set_descriptors()</a>, <a class="el" href="pocket_8c-source.html#l00170">updateIds()</a>, <a class="el" href="voronoi_8c-source.html#l00624">write_pdb_vert()</a>, and <a class="el" href="voronoi_8c-source.html#l00651">write_pqr_vert()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a997988bdd54ed39def3d823c9cf0c50"></a><!-- doxytag: member="voronoi.h::M_BUFSIZE" ref="a997988bdd54ed39def3d823c9cf0c50" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_BUFSIZE&nbsp;&nbsp;&nbsp;1e7          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
buffer size 
<p>Definition at line <a class="el" href="voronoi_8h-source.html#l00061">61</a> of file <a class="el" href="voronoi_8h-source.html">voronoi.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="235175bd6aa1a2a3b3d35e6e4445365e"></a><!-- doxytag: member="voronoi.h::M_POLAR_AS" ref="235175bd6aa1a2a3b3d35e6e4445365e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_POLAR_AS&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
tolerance for coordinate imprecion during alpha sphere search 
<p>Definition at line <a class="el" href="voronoi_8h-source.html#l00058">58</a> of file <a class="el" href="voronoi_8h-source.html">voronoi.h</a>.</p>

<p>Referenced by <a class="el" href="voronoi_8c-source.html#l00187">fill_vvertices()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9a3c197b6aed2e738902d35219c94c61"></a><!-- doxytag: member="voronoi.h::M_PREC_TOLERANCE" ref="9a3c197b6aed2e738902d35219c94c61" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PREC_TOLERANCE&nbsp;&nbsp;&nbsp;1e-5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="voronoi_8h-source.html#l00059">59</a> of file <a class="el" href="voronoi_8h-source.html">voronoi.h</a>.</p>

<p>Referenced by <a class="el" href="voronoi_8c-source.html#l00359">testVvertice()</a>.</p>

</div>
</div><p>
<a class="anchor" name="beb4af6653b4d1cb89cb62f3cf87cf17"></a><!-- doxytag: member="voronoi.h::M_VORONOI_SUCCESS" ref="beb4af6653b4d1cb89cb62f3cf87cf17" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_VORONOI_SUCCESS&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
alpha sphere type - hydrophobic alpha sphere 
<p>Definition at line <a class="el" href="voronoi_8h-source.html#l00056">56</a> of file <a class="el" href="voronoi_8h-source.html">voronoi.h</a>.</p>

<p>Referenced by <a class="el" href="voronoi_8c-source.html#l00090">load_vvertices()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="5d8ea86290bf16a736c4ae0bdd9b0baa"></a><!-- doxytag: member="voronoi.h::free_vert_lst" ref="5d8ea86290bf16a736c4ae0bdd9b0baa" args="(s_lst_vvertice *lvvert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_vert_lst           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *&nbsp;</td>
          <td class="paramname"> <em>lvvert</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: free_vert_lst<p>
## SPECIFICATION: Free memory<p>
## PARAMETERS: @ <a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *lvvert : Data to free<p>
## RETURN: void 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00530">530</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>References <a class="el" href="voronoi_8h-source.html#l00098">s_lst_vvertice::h_tr</a>, <a class="el" href="memhandler_8c-source.html#l00255">my_free()</a>, <a class="el" href="voronoi_8h-source.html#l00096">s_lst_vvertice::pvertices</a>, <a class="el" href="voronoi_8h-source.html#l00100">s_lst_vvertice::tr</a>, and <a class="el" href="voronoi_8h-source.html#l00095">s_lst_vvertice::vertices</a>.</p>

<p>Referenced by <a class="el" href="pocket_8c-source.html#l01214">c_lst_pocket_free()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00531"></a>00531 {
<a name="l00532"></a>00532     <span class="keywordflow">if</span>(lvvert) {
<a name="l00533"></a>00533 
<a name="l00534"></a>00534         <span class="keywordflow">if</span>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>) {
<a name="l00535"></a>00535             <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>) ;
<a name="l00536"></a>00536             lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a> = NULL ;
<a name="l00537"></a>00537         }
<a name="l00538"></a>00538         <span class="keywordflow">if</span>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#638d9ede844bca411ed99cb8e22b0e56">pvertices</a>) {
<a name="l00539"></a>00539             <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#638d9ede844bca411ed99cb8e22b0e56">pvertices</a>) ;
<a name="l00540"></a>00540             lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#638d9ede844bca411ed99cb8e22b0e56">pvertices</a> = NULL ;
<a name="l00541"></a>00541         }
<a name="l00542"></a>00542         <span class="keywordflow">if</span>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#d7a495083cb4d89a4775007fb1ad3115">tr</a>) {
<a name="l00543"></a>00543                 <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#d7a495083cb4d89a4775007fb1ad3115">tr</a>) ;
<a name="l00544"></a>00544                 lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#d7a495083cb4d89a4775007fb1ad3115">tr</a> = NULL ;
<a name="l00545"></a>00545         }
<a name="l00546"></a>00546         <span class="keywordflow">if</span>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>) {
<a name="l00547"></a>00547                 <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>) ;
<a name="l00548"></a>00548                 lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a> = NULL ;
<a name="l00549"></a>00549         }
<a name="l00550"></a>00550         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(lvvert) ;
<a name="l00551"></a>00551     }
<a name="l00552"></a>00552 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="621631ed13a0e6d72412f1551969a655"></a><!-- doxytag: member="voronoi.h::get_verts_volume_ptr" ref="621631ed13a0e6d72412f1551969a655" args="(s_vvertice **verts, int nvert, int niter, float correct)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float get_verts_volume_ptr           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__vvertice.html">s_vvertice</a> **&nbsp;</td>
          <td class="paramname"> <em>verts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nvert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>niter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>correct</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: get_verts_volume_ptr<p>
## SPECIFICATION: Get an monte carlo approximation of the volume occupied by the alpha spheres given in argument (list of pointers)<p>
## PARAMETRES: @ <a class="el" href="structs__vvertice.html">s_vvertice</a> **verts: List of pointer to alpha spheres @ int nvert: Number of spheres @ int niter: Number of monte carlo iteration to perform @ float correct: radius for which the size of an alpha sphere should be corrected in order to calculate the volume<p>
## RETURN: float: volume. 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00454">454</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>References <a class="el" href="utils_8c-source.html#l00123">rand_uniform()</a>, <a class="el" href="voronoi_8h-source.html#l00075">s_vvertice::ray</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::x</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::y</a>, and <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::z</a>.</p>

<p>Referenced by <a class="el" href="descriptors_8c-source.html#l00182">set_descriptors()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00455"></a>00455 {
<a name="l00456"></a>00456         <span class="keywordtype">int</span> i = 0, j = 0,
<a name="l00457"></a>00457                 nb_in = 0;
<a name="l00458"></a>00458 
<a name="l00459"></a>00459         <span class="keywordtype">float</span> xmin = 0.0, xmax = 0.0,
<a name="l00460"></a>00460                   ymin = 0.0, ymax = 0.0,
<a name="l00461"></a>00461                   zmin = 0.0, zmax = 0.0,
<a name="l00462"></a>00462                   xtmp = 0.0, ytmp = 0.0, ztmp = 0.0,
<a name="l00463"></a>00463                   xr   = 0.0, yr   = 0.0, zr   = 0.0,
<a name="l00464"></a>00464                   vbox = 0.0 ;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466         <a class="code" href="structs__vvertice.html">s_vvertice</a> *vcur = NULL ;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468         <span class="comment">/* First, search extrems coordinates to get a contour box of the molecule */</span>
<a name="l00469"></a>00469         <span class="keywordflow">for</span>(i = 0 ; i &lt; nvert ; i++) {
<a name="l00470"></a>00470                 vcur = verts[i] ;
<a name="l00471"></a>00471 
<a name="l00472"></a>00472                 <span class="keywordflow">if</span>(i == 0) {
<a name="l00473"></a>00473                         xmin = vcur-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a> - vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct ; xmax = vcur-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a> + vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct ;
<a name="l00474"></a>00474                         ymin = vcur-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a> - vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct ; ymax = vcur-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a> + vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct ;
<a name="l00475"></a>00475                         zmin = vcur-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a> - vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct ; zmax = vcur-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a> + vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct ;
<a name="l00476"></a>00476                 }
<a name="l00477"></a>00477                 <span class="keywordflow">else</span> {
<a name="l00478"></a>00478                 <span class="comment">/* Update the minimum and maximum extreme point */</span>
<a name="l00479"></a>00479                         <span class="keywordflow">if</span>(xmin &gt; (xtmp = vcur-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a> - vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct)) xmin = xtmp ;
<a name="l00480"></a>00480                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(xmax &lt; (xtmp = vcur-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a> + vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct)) xmax = xtmp ;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482                         <span class="keywordflow">if</span>(ymin &gt; (ytmp = vcur-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a> - vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct)) ymin = ytmp ;
<a name="l00483"></a>00483                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ymax &lt; (ytmp = vcur-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a> + vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct)) ymax = ytmp ;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485                         <span class="keywordflow">if</span>(zmin &gt; (ztmp = vcur-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a> - vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct)) zmin = ztmp ;
<a name="l00486"></a>00486                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(zmax &lt; (ztmp = vcur-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a> + vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct)) zmax = ztmp ;
<a name="l00487"></a>00487                 }
<a name="l00488"></a>00488         }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490         <span class="comment">/* Next calculate the contour box volume */</span>
<a name="l00491"></a>00491         vbox = (xmax - xmin)*(ymax - ymin)*(zmax - zmin) ;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493         <span class="comment">/* Then apply monte carlo approximation of the volume.   */</span>
<a name="l00494"></a>00494         <span class="keywordflow">for</span>(i = 0 ; i &lt; niter ; i++) {
<a name="l00495"></a>00495                 xr = <a class="code" href="utils_8c.html#5492196e16ed2d16bae1df8483ef79ed">rand_uniform</a>(xmin, xmax) ;
<a name="l00496"></a>00496                 yr = <a class="code" href="utils_8c.html#5492196e16ed2d16bae1df8483ef79ed">rand_uniform</a>(ymin, ymax) ;
<a name="l00497"></a>00497                 zr = <a class="code" href="utils_8c.html#5492196e16ed2d16bae1df8483ef79ed">rand_uniform</a>(zmin, zmax) ;
<a name="l00498"></a>00498 
<a name="l00499"></a>00499                 <span class="keywordflow">for</span>(j = 0 ; j &lt; nvert ; j++) {
<a name="l00500"></a>00500                         vcur = verts[j] ;
<a name="l00501"></a>00501                         xtmp = vcur-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a> - xr ;
<a name="l00502"></a>00502                         ytmp = vcur-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a> - yr ;
<a name="l00503"></a>00503                         ztmp = vcur-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a> - zr ;
<a name="l00504"></a>00504 
<a name="l00505"></a>00505                 <span class="comment">/* Compare r^2 and dist(center, random_point)^2 */</span>
<a name="l00506"></a>00506                         <span class="keywordflow">if</span>(((correct+vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a>)*(vcur-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a> + correct)) &gt; (xtmp*xtmp + ytmp*ytmp + ztmp*ztmp)) {
<a name="l00507"></a>00507                         <span class="comment">/* The point is inside one of the vertice!! */</span>
<a name="l00508"></a>00508                                 nb_in ++ ; break ;
<a name="l00509"></a>00509                         }
<a name="l00510"></a>00510                 }
<a name="l00511"></a>00511         }
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         <span class="comment">/* Ok lets just return the volume Vpok = Nb_in/Niter*Vbox */</span>
<a name="l00514"></a>00514         <span class="keywordflow">return</span> ((<span class="keywordtype">float</span>)nb_in)/((float)niter)*vbox;
<a name="l00515"></a>00515 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e3ecf2620f9bec82cc0180c2efd5c091"></a><!-- doxytag: member="voronoi.h::is_in_lst_vert" ref="e3ecf2620f9bec82cc0180c2efd5c091" args="(s_vvertice **lst_vert, int nb_vert, int v_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_in_lst_vert           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__vvertice.html">s_vvertice</a> **&nbsp;</td>
          <td class="paramname"> <em>lst_vert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nb_vert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>v_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: is_in_lst_vert<p>
## SPECIFICATION: Says wether a vertice of id v_id is in a list of vertices or not<p>
## PARAMETRES:<p>
## RETURN: 1 if the vertice is in the tab, 0 if not 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00567">567</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>Referenced by <a class="el" href="neighbor_8c-source.html#l00213">get_mol_vert_neigh()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00568"></a>00568 {
<a name="l00569"></a>00569         <span class="keywordtype">int</span> i ;
<a name="l00570"></a>00570         <span class="keywordflow">for</span>(i = 0 ; i &lt; nb_vert ; i++) {
<a name="l00571"></a>00571                 <span class="keywordflow">if</span>(v_id == lst_vert[i]-&gt;<span class="keywordtype">id</span>) <span class="keywordflow">return</span> 1 ;
<a name="l00572"></a>00572         }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574         <span class="keywordflow">return</span> 0 ;
<a name="l00575"></a>00575 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8553105087cea62c70a4c33d4f18aa96"></a><!-- doxytag: member="voronoi.h::is_in_lst_vert_p" ref="8553105087cea62c70a4c33d4f18aa96" args="(s_vvertice **lst_vert, int nb_vert, s_vvertice *vert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_in_lst_vert_p           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__vvertice.html">s_vvertice</a> **&nbsp;</td>
          <td class="paramname"> <em>lst_vert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nb_vert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__vvertice.html">s_vvertice</a> *&nbsp;</td>
          <td class="paramname"> <em>vert</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: is_in_lst_vert<p>
## SPECIFICATION: Says wether a vertice of id v_id is in a list of vertices or not<p>
## PARAMETRES:<p>
## RETURN: 1 if the vertice is in the tab, 0 if not 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00590">590</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00591"></a>00591 {
<a name="l00592"></a>00592         <span class="keywordtype">int</span> i ;
<a name="l00593"></a>00593         <span class="keywordflow">for</span>(i = 0 ; i &lt; nb_vert ; i++) {
<a name="l00594"></a>00594                 <span class="keywordflow">if</span>(vert == lst_vert[i]) <span class="keywordflow">return</span> 1 ;
<a name="l00595"></a>00595         }
<a name="l00596"></a>00596 
<a name="l00597"></a>00597         <span class="keywordflow">return</span> 0 ;
<a name="l00598"></a>00598 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4d3a0a72e8648578095af06f60c5e66c"></a><!-- doxytag: member="voronoi.h::load_vvertices" ref="4d3a0a72e8648578095af06f60c5e66c" args="(s_pdb *pdb, int min_apol_neigh, float ashape_min_size, float ashape_max_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a>* load_vvertices           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__pdb.html">s_pdb</a> *&nbsp;</td>
          <td class="paramname"> <em>pdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>min_apol_neigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>asph_min_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>asph_max_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: <a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a><p>
## SPECIFICATION: Calculate voronoi vertices using an ensemble of atoms, and then load resulting vertices into a <a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> structure. The function call an external programm qvoronoi, part of qhull programme which can be download at: <a href="http://www.qhull.org/download/">http://www.qhull.org/download/</a> or installed with apt-get install qhull-bin<p>
## PARAMETRES: @ <a class="el" href="structs__pdb.html">s_pdb</a> *pdb : PDB informations @ int min_apol_neigh : Number of apolar neighbor of a vertice to be considered as apolar @ float asph_min_size : Minimum size of voronoi vertices to retain @ float asph_max_size : Maximum size of voronoi vertices to retain<p>
## RETURN: <a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> * :The structure containing the list of vertices. 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00090">90</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>References <a class="el" href="voronoi_8c-source.html#l00187">fill_vvertices()</a>, <a class="el" href="voronoi_8h-source.html#l00098">s_lst_vvertice::h_tr</a>, <a class="el" href="rpdb_8h-source.html#l00072">s_pdb::latoms</a>, <a class="el" href="voronoi_8h-source.html#l00056">M_VORONOI_SUCCESS</a>, <a class="el" href="memhandler_8c-source.html#l00255">my_free()</a>, <a class="el" href="memhandler_8c-source.html#l00121">my_malloc()</a>, <a class="el" href="memhandler_8c-source.html#l00184">my_realloc()</a>, <a class="el" href="voronoi_8h-source.html#l00099">s_lst_vvertice::n_h_tr</a>, <a class="el" href="rpdb_8h-source.html#l00078">s_pdb::natoms</a>, <a class="el" href="atom_8h-source.html#l00057">s_atm::symbol</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>.</p>

<p>Referenced by <a class="el" href="fpocket_8c-source.html#l00082">search_pocket()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00091"></a>00091 {
<a name="l00092"></a>00092         <span class="keywordtype">int</span> i, nb_h=0;
<a name="l00093"></a>00093         <a class="code" href="structs__atm.html">s_atm</a> *ca = NULL ;
<a name="l00094"></a>00094         <a class="code" href="structs__lst__vvertice.html">s_lst_vvertice</a> *lvvert = NULL ;
<a name="l00095"></a>00095         <span class="keywordtype">char</span> tmpn1[250]=<span class="stringliteral">""</span>;
<a name="l00096"></a>00096         <span class="keywordtype">char</span> tmpn2[250]=<span class="stringliteral">""</span>;
<a name="l00097"></a>00097         pid_t pid=getpid();
<a name="l00098"></a>00098         sprintf(tmpn1,<span class="stringliteral">"/tmp/qvoro_tmp_%d.dat"</span>,pid);
<a name="l00099"></a>00099         sprintf(tmpn2,<span class="stringliteral">"/tmp/fpocket_qvor_%d.dat"</span>,pid);
<a name="l00100"></a>00100         FILE *fvoro = fopen(tmpn1, <span class="stringliteral">"w+"</span>);
<a name="l00101"></a>00101         FILE *ftmp=fopen(tmpn2,<span class="stringliteral">"w"</span>);
<a name="l00102"></a>00102         <span class="comment">/*FILE *ftmp=fopen("/tmp/fpocket_qvor.dat","w");</span>
<a name="l00103"></a>00103 <span class="comment">        FILE *fvoro = fopen("/tmp/qvoro_tmp.dat", "w+");*/</span>
<a name="l00104"></a>00104 <span class="comment">/*      lvvert-&gt;h_tr=(int *)my_malloc(sizeof(int));*/</span>
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 
<a name="l00108"></a>00108         <span class="keywordflow">if</span>(fvoro != NULL) {
<a name="l00109"></a>00109                 lvvert = (<a class="code" href="structs__lst__vvertice.html">s_lst_vvertice</a> *)<a class="code" href="memhandler_8c.html#52d7260a38c396cb2dd1dd7abcfd61cb">my_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structs__lst__vvertice.html">s_lst_vvertice</a>)) ;
<a name="l00110"></a>00110                 lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>=NULL;
<a name="l00111"></a>00111                 <span class="comment">/* Loop a first time to get out how many heavy atoms are in the file */</span>
<a name="l00112"></a>00112                 <span class="keywordflow">for</span>(i = 0; i &lt;  pdb-&gt;<a class="code" href="structs__pdb.html#85aaf7bdb931bb303af1ca736a998b98">natoms</a> ; i++){
<a name="l00113"></a>00113                         ca = (pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a>)+i ;
<a name="l00114"></a>00114                         <span class="keywordflow">if</span>(strcmp(ca-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>,<span class="stringliteral">"H"</span>)) {
<a name="l00115"></a>00115                                 lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>=(<span class="keywordtype">int</span> *)<a class="code" href="memhandler_8c.html#ede15d67c845c05e9b2bfb59b8ab6cf7">my_realloc</a>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(i-nb_h+1)) ;
<a name="l00116"></a>00116                                 lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>[i-nb_h]=i ;
<a name="l00117"></a>00117                         }
<a name="l00118"></a>00118                         <span class="keywordflow">else</span> nb_h++;
<a name="l00119"></a>00119                 }
<a name="l00120"></a>00120                 lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#8e4c0be6b621ade71df924faf66fbd82">n_h_tr</a>=i-nb_h;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122                 <span class="comment">/* Write the header for qvoronoi */</span>
<a name="l00123"></a>00123                 fprintf(fvoro,<span class="stringliteral">"3 rbox D3\n%d\n"</span>, lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#8e4c0be6b621ade71df924faf66fbd82">n_h_tr</a>);
<a name="l00124"></a>00124                 <span class="comment">/* Loop a second time for the qvoronoi input coordinates */</span>
<a name="l00125"></a>00125                 <span class="keywordflow">for</span>(i = 0; i &lt;  pdb-&gt;<a class="code" href="structs__pdb.html#85aaf7bdb931bb303af1ca736a998b98">natoms</a> ; i++){
<a name="l00126"></a>00126                         ca = (pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a>)+i ;
<a name="l00127"></a>00127                         <span class="keywordflow">if</span>(strcmp(ca-&gt;<a class="code" href="structs__atm.html#c80daffa94edeadd30433f6653e08054">symbol</a>,<span class="stringliteral">"H"</span>)) {
<a name="l00128"></a>00128                         <span class="comment">/* Only if this is a heavy atom export it for voronoi tesselation,</span>
<a name="l00129"></a>00129 <span class="comment">                         * else discard it */</span>
<a name="l00130"></a>00130                                 fprintf(fvoro,<span class="stringliteral">"%.3f %.3f %.3f \n"</span>, ca-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, ca-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, ca-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>);
<a name="l00131"></a>00131                         }
<a name="l00132"></a>00132                 }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134                 fflush(fvoro) ;
<a name="l00135"></a>00135                 rewind(fvoro);
<a name="l00136"></a>00136                 
<a name="l00137"></a>00137                 <span class="comment">//int status = system("qvoronoi p i Pp Fn &lt; voro_tmp.dat &gt; voro.tmp") ;</span>
<a name="l00138"></a>00138                 run_qvoronoi(fvoro,ftmp);
<a name="l00139"></a>00139                 <span class="keywordtype">int</span> status=<a class="code" href="voronoi_8h.html#beb4af6653b4d1cb89cb62f3cf87cf17">M_VORONOI_SUCCESS</a>;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 
<a name="l00142"></a>00142               
<a name="l00143"></a>00143                 <span class="keywordflow">if</span>(status == <a class="code" href="voronoi_8h.html#beb4af6653b4d1cb89cb62f3cf87cf17">M_VORONOI_SUCCESS</a>) {
<a name="l00144"></a>00144                         <a class="code" href="voronoi_8c.html#10b382a23c17d4fca5d9ea5be5f36814">fill_vvertices</a>(lvvert, tmpn2, pdb-&gt;<a class="code" href="structs__pdb.html#3b0fff968487b66aa1c88e55d45120e4">latoms</a>, pdb-&gt;<a class="code" href="structs__pdb.html#85aaf7bdb931bb303af1ca736a998b98">natoms</a>,
<a name="l00145"></a>00145                                                         min_apol_neigh, asph_min_size, asph_max_size);
<a name="l00146"></a>00146                 }
<a name="l00147"></a>00147                 <span class="keywordflow">else</span> {
<a name="l00148"></a>00148                         <a class="code" href="memhandler_8c.html#a49400242a007d208c641f79856ea4c6">my_free</a>(lvvert);
<a name="l00149"></a>00149                         lvvert = NULL ;
<a name="l00150"></a>00150                         fprintf(stderr, <span class="stringliteral">"! Voronoi command failed with status %d...\n"</span>, status) ;
<a name="l00151"></a>00151                 }
<a name="l00152"></a>00152                 
<a name="l00153"></a>00153           
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155         <span class="keywordflow">else</span> {
<a name="l00156"></a>00156                 fprintf(stderr, <span class="stringliteral">"! File for Voronoi vertices calculation couldn't be opened...\n"</span>) ;
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158         fclose(fvoro) ;
<a name="l00159"></a>00159         fclose(ftmp);
<a name="l00160"></a>00160         <span class="keyword">remove</span>(tmpn1);
<a name="l00161"></a>00161         <span class="keyword">remove</span>(tmpn2);
<a name="l00162"></a>00162         <span class="keywordflow">return</span> lvvert ;
<a name="l00163"></a>00163 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0268e8ccbb2743b5e94e398a094644aa"></a><!-- doxytag: member="voronoi.h::print_vvertices" ref="0268e8ccbb2743b5e94e398a094644aa" args="(FILE *f, s_lst_vvertice *lvvert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_vvertices           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *&nbsp;</td>
          <td class="paramname"> <em>lvvert</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: print_vvertices<p>
## SPECIFICATION: Print function.<p>
## PARAMETERS: @ FILE *f : Buffer to print in @ <a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *lvvert : Vertices to print<p>
## RETURN: void 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00411">411</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>References <a class="el" href="calc_8c-source.html#l00075">dist()</a>, <a class="el" href="atom_8h-source.html#l00063">s_atm::id</a>, <a class="el" href="voronoi_8h-source.html#l00084">s_vvertice::neigh</a>, <a class="el" href="voronoi_8h-source.html#l00100">s_lst_vvertice::nvert</a>, <a class="el" href="voronoi_8h-source.html#l00080">s_vvertice::sort_x</a>, <a class="el" href="voronoi_8h-source.html#l00095">s_lst_vvertice::vertices</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::y</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>, and <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::z</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00412"></a>00412 {
<a name="l00413"></a>00413         <span class="keywordflow">if</span>(lvvert) {
<a name="l00414"></a>00414                 <span class="keywordflow">if</span>(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>) {
<a name="l00415"></a>00415                         <span class="keywordtype">int</span> i ;
<a name="l00416"></a>00416                         <span class="keywordflow">for</span>(i = 0 ; i &lt; lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#c6b07ac45ca65ccd944b68afd4c18bfb">nvert</a> ; i++) {
<a name="l00417"></a>00417                                 <a class="code" href="structs__vvertice.html">s_vvertice</a> *v = &amp;(lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#81f278e6754408ea7de3a0f5d7aca6dc">vertices</a>[i]) ;
<a name="l00418"></a>00418                                 <span class="keywordflow">if</span>( v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[0] &amp;&amp;  v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[1] &amp;&amp; v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[2] &amp;&amp;  v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[3]) {
<a name="l00419"></a>00419                                         fprintf(f, <span class="stringliteral">"====== Vertice %d: =====\n"</span>, i);
<a name="l00420"></a>00420                                         fprintf(f, <span class="stringliteral">"- x = %f, y = %f, z = %f\n"</span>, v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>);
<a name="l00421"></a>00421                                         fprintf(f, <span class="stringliteral">"- ix = %d\n"</span>,v-&gt;<a class="code" href="structs__vvertice.html#a47fae81830953dca2c9262abc8ff876">sort_x</a>);
<a name="l00422"></a>00422 
<a name="l00423"></a>00423                                         <span class="keywordtype">float</span> d1 = <a class="code" href="calc_8c.html#615f3353fc9ccc88069adb4000b21e73">dist</a>(v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[0]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[0]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[0]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>) ;
<a name="l00424"></a>00424                                         <span class="keywordtype">float</span> d2 = <a class="code" href="calc_8c.html#615f3353fc9ccc88069adb4000b21e73">dist</a>(v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[1]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[1]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[1]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>) ;
<a name="l00425"></a>00425                                         <span class="keywordtype">float</span> d3 = <a class="code" href="calc_8c.html#615f3353fc9ccc88069adb4000b21e73">dist</a>(v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[2]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[2]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[2]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>) ;
<a name="l00426"></a>00426                                         <span class="keywordtype">float</span> d4 = <a class="code" href="calc_8c.html#615f3353fc9ccc88069adb4000b21e73">dist</a>(v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[3]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[3]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[3]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>) ;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428                                         fprintf(f, <span class="stringliteral">"- Neighbour: \n1 - %f (%f %f %f: %d) \n2 - %f (%f %f %f: %d)\n3 - %f (%f %f %f: %d)\n4 - %f (%f %f %f: %d)\n"</span>, d1, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[0]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[0]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[0]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[0]-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>, d2, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[1]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[1]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[1]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[1]-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>, d3, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[2]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>,  v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[2]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a> ,  v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[2]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[2]-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>, d4, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[3]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[3]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[3]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>, v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[3]-&gt;<a class="code" href="structs__atm.html#88237f06aa7a10cd6b382c19b800f230">id</a>);
<a name="l00429"></a>00429                                 }
<a name="l00430"></a>00430                         }
<a name="l00431"></a>00431                 }
<a name="l00432"></a>00432         }
<a name="l00433"></a>00433 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0cffdb4ff10d2af2fbdc139b7b789c06"></a><!-- doxytag: member="voronoi.h::set_barycenter" ref="0cffdb4ff10d2af2fbdc139b7b789c06" args="(s_vvertice *v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_barycenter           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__vvertice.html">s_vvertice</a> *&nbsp;</td>
          <td class="paramname"> <em>v</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: set_barycenter<p>
## SPECIFICATION: Set barycenter of a vertice using it's 4 contacting atoms.<p>
## PARAMETERS: @ <a class="el" href="structs__vvertice.html">s_vvertice</a> *v: The vertice<p>
## RETURN: void 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00321">321</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>References <a class="el" href="voronoi_8h-source.html#l00086">s_vvertice::bary</a>, <a class="el" href="voronoi_8h-source.html#l00084">s_vvertice::neigh</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>.</p>

<p>Referenced by <a class="el" href="voronoi_8c-source.html#l00187">fill_vvertices()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00322"></a>00322 {
<a name="l00323"></a>00323         <span class="keywordtype">int</span> i ;
<a name="l00324"></a>00324         <span class="keywordtype">float</span> xsum = 0.0,
<a name="l00325"></a>00325                   ysum = 0.0,
<a name="l00326"></a>00326                   zsum = 0.0 ;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328         <span class="keywordflow">for</span>(i = 0 ; i &lt; 4 ; i++) {
<a name="l00329"></a>00329                 xsum += v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[i]-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a> ;
<a name="l00330"></a>00330                 ysum += v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[i]-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a> ;
<a name="l00331"></a>00331                 zsum += v-&gt;<a class="code" href="structs__vvertice.html#d8f82150ff5b05ee09b1136a9c09cfd0">neigh</a>[i]-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a> ;
<a name="l00332"></a>00332         }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334         v-&gt;<a class="code" href="structs__vvertice.html#158f2fc12fef57205ad4f951bf20caea">bary</a>[0] = xsum*0.25 ;
<a name="l00335"></a>00335         v-&gt;<a class="code" href="structs__vvertice.html#158f2fc12fef57205ad4f951bf20caea">bary</a>[1] = ysum*0.25 ;
<a name="l00336"></a>00336         v-&gt;<a class="code" href="structs__vvertice.html#158f2fc12fef57205ad4f951bf20caea">bary</a>[2] = zsum*0.25 ;
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ff07f3be2fee9344d3fcecd3b18aac62"></a><!-- doxytag: member="voronoi.h::testVvertice" ref="ff07f3be2fee9344d3fcecd3b18aac62" args="(float xyz[3], int curNbIdx[4], s_atm *atoms, float min_asph_size, float max_asph_size, s_lst_vvertice *lvvert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float testVvertice           </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>xyz</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>curNbIdx</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__atm.html">s_atm</a> *&nbsp;</td>
          <td class="paramname"> <em>atoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>min_asph_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>max_asph_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__lst__vvertice.html">s_lst_vvertice</a> *&nbsp;</td>
          <td class="paramname"> <em>lvvert</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: testVvertice<p>
## SPECIFICATION: Test if alpha sphere conditions are fulfilled for current vertice<p>
## PARAMETERS: @ float xyz[3] : Coordinates of current vertice @ int curNbIdx[4] : Indexes of atomic neighbours of the current vertice @ <a class="el" href="structs__atm.html">s_atm</a> *atoms : List of all atoms @ float min_asph_size : Minimum size of alpha spheres. @ float max_asph_size : Maximum size of alpha spheres.<p>
## RETURN: float : -1 if conditions are not fulfilled, else the alpha sphere radius is returned. 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00359">359</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>References <a class="el" href="calc_8c-source.html#l00075">dist()</a>, <a class="el" href="voronoi_8h-source.html#l00098">s_lst_vvertice::h_tr</a>, <a class="el" href="voronoi_8h-source.html#l00059">M_PREC_TOLERANCE</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::x</a>, <a class="el" href="atom_8h-source.html#l00056">s_atm::y</a>, and <a class="el" href="atom_8h-source.html#l00056">s_atm::z</a>.</p>

<p>Referenced by <a class="el" href="voronoi_8c-source.html#l00187">fill_vvertices()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00362"></a>00362 {
<a name="l00363"></a>00363         <span class="keywordtype">float</span> x = xyz[0],
<a name="l00364"></a>00364                   y = xyz[1],
<a name="l00365"></a>00365                   z = xyz[2] ;
<a name="l00366"></a>00366 
<a name="l00367"></a>00367         <a class="code" href="structs__atm.html">s_atm</a> *cura = &amp;(atoms[lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>[curNbIdx[0]]]) ;
<a name="l00368"></a>00368 
<a name="l00369"></a>00369         <span class="keywordtype">float</span> distVatom1 = <a class="code" href="calc_8c.html#615f3353fc9ccc88069adb4000b21e73">dist</a>(x, y, z, cura-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, cura-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, cura-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>) ;
<a name="l00370"></a>00370         <span class="keywordtype">float</span> distVatom2,
<a name="l00371"></a>00371                   distVatom3,
<a name="l00372"></a>00372                   distVatom4;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         <span class="keywordflow">if</span>(min_asph_size &lt;= distVatom1 + <a class="code" href="voronoi_8h.html#9a3c197b6aed2e738902d35219c94c61">M_PREC_TOLERANCE</a>  &amp;&amp; distVatom1 - <a class="code" href="voronoi_8h.html#9a3c197b6aed2e738902d35219c94c61">M_PREC_TOLERANCE</a> &lt;= max_asph_size){
<a name="l00375"></a>00375                 cura = &amp;(atoms[lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>[curNbIdx[1]]]) ;
<a name="l00376"></a>00376                 distVatom2 = <a class="code" href="calc_8c.html#615f3353fc9ccc88069adb4000b21e73">dist</a>(x, y, z, cura-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, cura-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, cura-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>);
<a name="l00377"></a>00377 
<a name="l00378"></a>00378                 cura = &amp;(atoms[lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>[curNbIdx[2]]]) ;
<a name="l00379"></a>00379                 distVatom3 = <a class="code" href="calc_8c.html#615f3353fc9ccc88069adb4000b21e73">dist</a>(x, y, z, cura-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, cura-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, cura-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>);
<a name="l00380"></a>00380 
<a name="l00381"></a>00381                 cura = &amp;(atoms[lvvert-&gt;<a class="code" href="structs__lst__vvertice.html#7ab1882e21a9060b6317df7e49fbfa5f">h_tr</a>[curNbIdx[3]]]) ;
<a name="l00382"></a>00382                 distVatom4=<a class="code" href="calc_8c.html#615f3353fc9ccc88069adb4000b21e73">dist</a>(x, y, z, cura-&gt;<a class="code" href="structs__atm.html#2bf748fbcd9b6d0a472b292a6b244ed5">x</a>, cura-&gt;<a class="code" href="structs__atm.html#72534af707e830760a209fec348bc1af">y</a>, cura-&gt;<a class="code" href="structs__atm.html#f7cae749a2d07ffb393317f12745170a">z</a>);
<a name="l00383"></a>00383 
<a name="l00384"></a>00384                 <span class="comment">/* Test if all 4 neighbours are on the alpha sphere surface</span>
<a name="l00385"></a>00385 <span class="comment">                 * (approximate test) */</span>
<a name="l00386"></a>00386                 <span class="keywordflow">if</span>(fabs(distVatom1-distVatom2) &lt; <a class="code" href="voronoi_8h.html#9a3c197b6aed2e738902d35219c94c61">M_PREC_TOLERANCE</a> &amp;&amp;
<a name="l00387"></a>00387                    fabs(distVatom1-distVatom3)  &lt; <a class="code" href="voronoi_8h.html#9a3c197b6aed2e738902d35219c94c61">M_PREC_TOLERANCE</a> &amp;&amp;
<a name="l00388"></a>00388                    fabs(distVatom1-distVatom4) &lt; <a class="code" href="voronoi_8h.html#9a3c197b6aed2e738902d35219c94c61">M_PREC_TOLERANCE</a>){
<a name="l00389"></a>00389 
<a name="l00390"></a>00390                         <span class="keywordflow">return</span> distVatom1;
<a name="l00391"></a>00391                 }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394         <span class="keywordflow">return</span> -1.0;
<a name="l00395"></a>00395 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="624ae3215f4659770cd761d5bbb70a39"></a><!-- doxytag: member="voronoi.h::write_pdb_vert" ref="624ae3215f4659770cd761d5bbb70a39" args="(FILE *f, s_vvertice *v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_pdb_vert           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__vvertice.html">s_vvertice</a> *&nbsp;</td>
          <td class="paramname"> <em>v</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
-- --<p>
OUTPUT FUNCTIONS<p>
-- -- -- ## FUNCTION: void write_pdb_vertice(FILE *f, s_vvertice *v)<p>
## SPECIFICATION: Write a voronoi vertice in pdb format.<p>
## PARAMETRES: @ FILE *f: file to write in @ <a class="el" href="structs__vvertice.html">s_vvertice</a> *v: The vertice<p>
## RETURN: 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00624">624</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>References <a class="el" href="voronoi_8h-source.html#l00070">s_vvertice::id</a>, <a class="el" href="voronoi_8h-source.html#l00057">M_APOLAR_AS</a>, <a class="el" href="voronoi_8h-source.html#l00069">s_vvertice::resid</a>, <a class="el" href="voronoi_8h-source.html#l00070">s_vvertice::type</a>, <a class="el" href="writepdb_8c-source.html#l00093">write_pdb_atom_line()</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::x</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::y</a>, and <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::z</a>.</p>

<p>Referenced by <a class="el" href="writepocket_8c-source.html#l00213">write_pockets_single_pdb()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00625"></a>00625 {
<a name="l00626"></a>00626         <span class="keywordflow">if</span>(v-&gt;<a class="code" href="structs__vvertice.html#7cd4bd55a93f3400449ef354b49bb4c3">type</a>==<a class="code" href="voronoi_8h.html#e90a1520c3ca5a4b829d387d4d06b004">M_APOLAR_AS</a>) <a class="code" href="writepdb_8c.html#c1826cac257476a6fe47825b31cafb4d">write_pdb_atom_line</a>(f, <span class="stringliteral">"HETATM"</span>, v-&gt;<a class="code" href="structs__vvertice.html#e66571bccd6d8e3f809b4315fdcbf65e">id</a>, <span class="stringliteral">"APOL"</span>,
<a name="l00627"></a>00627                                                                                                  <span class="charliteral">' '</span>, <span class="stringliteral">"STP"</span>, <span class="stringliteral">"C"</span>, v-&gt;<a class="code" href="structs__vvertice.html#54bc1b392d46ab9a9a1ec164c1a2b431">resid</a>, <span class="charliteral">' '</span>,
<a name="l00628"></a>00628                                                                                                  v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>, 0.0, 0.0,
<a name="l00629"></a>00629                                                                                                  <span class="stringliteral">"Ve"</span>, -1);
<a name="l00630"></a>00630 
<a name="l00631"></a>00631         <span class="keywordflow">else</span> <a class="code" href="writepdb_8c.html#c1826cac257476a6fe47825b31cafb4d">write_pdb_atom_line</a>(f, <span class="stringliteral">"HETATM"</span>, v-&gt;<a class="code" href="structs__vvertice.html#e66571bccd6d8e3f809b4315fdcbf65e">id</a>, <span class="stringliteral">" POL"</span>, <span class="charliteral">' '</span>, <span class="stringliteral">"STP"</span>, <span class="stringliteral">"C"</span>,
<a name="l00632"></a>00632                                                                 v-&gt;<a class="code" href="structs__vvertice.html#54bc1b392d46ab9a9a1ec164c1a2b431">resid</a>, <span class="charliteral">' '</span>,v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>,0.0, 0.0,
<a name="l00633"></a>00633                                                                 <span class="stringliteral">"Ve"</span>, -1);
<a name="l00634"></a>00634 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0fc0360fbb0a071ba6d49dedd57ba397"></a><!-- doxytag: member="voronoi.h::write_pqr_vert" ref="0fc0360fbb0a071ba6d49dedd57ba397" args="(FILE *f, s_vvertice *v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_pqr_vert           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__vvertice.html">s_vvertice</a> *&nbsp;</td>
          <td class="paramname"> <em>v</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
## FUNCTION: write_pqr_vertice<p>
## SPECIFICATION: Write a voronoi vertice in pqr format.<p>
## PARAMETRES: @ FILE *f : file to write in @ <a class="el" href="structs__vvertice.html">s_vvertice</a> *v : The vertice<p>
## RETURN: void 
<p>Definition at line <a class="el" href="voronoi_8c-source.html#l00651">651</a> of file <a class="el" href="voronoi_8c-source.html">voronoi.c</a>.</p>

<p>References <a class="el" href="voronoi_8h-source.html#l00070">s_vvertice::id</a>, <a class="el" href="voronoi_8h-source.html#l00057">M_APOLAR_AS</a>, <a class="el" href="voronoi_8h-source.html#l00075">s_vvertice::ray</a>, <a class="el" href="voronoi_8h-source.html#l00069">s_vvertice::resid</a>, <a class="el" href="voronoi_8h-source.html#l00070">s_vvertice::type</a>, <a class="el" href="writepdb_8c-source.html#l00162">write_pqr_atom_line()</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::x</a>, <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::y</a>, and <a class="el" href="voronoi_8h-source.html#l00076">s_vvertice::z</a>.</p>

<p>Referenced by <a class="el" href="mdpocket_8c-source.html#l00217">mdpocket_characterize()</a>, <a class="el" href="writepocket_8c-source.html#l00347">write_mdpockets_concat_pqr()</a>, <a class="el" href="writepocket_8c-source.html#l00435">write_pocket_pqr()</a>, <a class="el" href="writepocket_8c-source.html#l00091">write_pocket_pqr_DB()</a>, and <a class="el" href="writepocket_8c-source.html#l00293">write_pockets_single_pqr()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00652"></a>00652 {
<a name="l00653"></a>00653         <span class="keywordflow">if</span>(v-&gt;<a class="code" href="structs__vvertice.html#7cd4bd55a93f3400449ef354b49bb4c3">type</a>==<a class="code" href="voronoi_8h.html#e90a1520c3ca5a4b829d387d4d06b004">M_APOLAR_AS</a>) <a class="code" href="writepdb_8c.html#92a5b208994d6b1cd8db116c93a158ac">write_pqr_atom_line</a>(f, <span class="stringliteral">"ATOM"</span>, v-&gt;<a class="code" href="structs__vvertice.html#e66571bccd6d8e3f809b4315fdcbf65e">id</a>, <span class="stringliteral">"APOL"</span>, <span class="charliteral">' '</span>,
<a name="l00654"></a>00654                                                                                                  <span class="stringliteral">"STP"</span>, <span class="stringliteral">" "</span>, v-&gt;<a class="code" href="structs__vvertice.html#54bc1b392d46ab9a9a1ec164c1a2b431">resid</a>, <span class="charliteral">' '</span>,
<a name="l00655"></a>00655                                                                                                   v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>, 0.0, v-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a>);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657         <span class="keywordflow">else</span> <a class="code" href="writepdb_8c.html#92a5b208994d6b1cd8db116c93a158ac">write_pqr_atom_line</a>(f, <span class="stringliteral">"ATOM"</span>, v-&gt;<a class="code" href="structs__vvertice.html#e66571bccd6d8e3f809b4315fdcbf65e">id</a>, <span class="stringliteral">" POL"</span>, <span class="charliteral">' '</span>, <span class="stringliteral">"STP"</span>, <span class="stringliteral">" "</span>,
<a name="l00658"></a>00658                                                          v-&gt;<a class="code" href="structs__vvertice.html#54bc1b392d46ab9a9a1ec164c1a2b431">resid</a>, <span class="charliteral">' '</span>,v-&gt;<a class="code" href="structs__vvertice.html#017f9695c923d87d851231bf13967b22">x</a>, v-&gt;<a class="code" href="structs__vvertice.html#250642d688398e4186819f63d54247bc">y</a>, v-&gt;<a class="code" href="structs__vvertice.html#3e03d11fd3b1d0ffb623481fa1b497b6">z</a>,0.0, v-&gt;<a class="code" href="structs__vvertice.html#0aadc589bd2213f3c6246e873cc69a83">ray</a>);
<a name="l00659"></a>00659 }
</pre></div>
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jun 7 16:44:23 2010 for fpocket by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
